# Hydrostatic Equilibrium

<!-- Tufte format from https://quarto-dev.github.io/quarto-gallery/page-layout/tufte.html  -->
The fundamental physics of stars is determined by a handful of principles: 

::: column-margin
hydrostatic from Greek ὕδωρ, 'water', and στάσις, 'standing'; just like water in a tank.
:::
- the star is everywhere in pressure balance under its own gravity, or *hydrostatic equilibrium*; 
- its cooling by radiation must be met by 
    - *energy production* in its interior by nuclear fusion or gravitational contraction, 
    - and *energy transport* to its surface by radiation, convection, and conduction; 
- how its material responds to pressure (parametrized the *equation of state*) and to light (parametrized by *opacity*); and
- in its interior and a star is typically rotating and magnetic, which we will neglect in most of these notes.

Let's talk about hydrostatic equilibrium first.

An ordinary star like the Sun, throughout its whole body, is to a very good approximation an *ideal gas*, and is fully ionized except in its outermost layer. This means that the gas pressure satisfies the equation of state

::: column-margin
where $\textcolor{blue}{p}$ is the <font color='blue'>pressure</font>, $n$ is the number density (particles per volume) of the gas, $\textcolor{red}{k_B}$ is <font color='red'>Boltzmann's constant</font> ($1.38\times10^{-16}$ erg/K), and $\textcolor{orange}{T}$ is the <font color='orange'>temperature</font> in kelvin.
:::
$$
\textcolor{blue}{p} = n \textcolor{red}{k_B} \textcolor{orange}{T}
$$


In a star like the Sun, the pressure is mostly provided by gas pressure. In hotter stars, *photon* or *radiation pressure* is dominant, but in the Sun this is $\sim 10^{-3} p_\text{gas}$. 

Even in the Sun, though, the gas is not *quite* a classical ideal gas: quantum mechanics is already relevant. There is an equation we will derive later in these notes for the pressure due to the *degeneracy* of a gas where the quantum wavefunctions of its constituent particles are nearly overlapping: 

::: column-margin
where $\textcolor{purple}{\hbar}$ is the <font color='purple'>quantum of action $h/2\pi$</font> ($1.0546 \times 10^{-27} \text{erg}\cdot\text{s}$), and $\textcolor{green}{m_e}$ the <font color='green'>mass of the electron</font>.
:::
$$
p_\text{degeneracy} = \frac{\textcolor{purple}{\hbar}}{5\textcolor{green}{m_e}} (\frac{3}{8 \pi})^{2/3} n^{5/3}
$$

It turns out this is about a quarter of the gas pressure at the core of the Sun! 

## The Equation of Hydrostatic Equilibrium

::: column-margin
i.e. $M_r$ is the total mass integrated out up to a radius $r$.
:::
Consider a thin shell of radius $r$ (and surface area $A = 4\pi r^2$), thickness $dr$, and mass density $\rho$, enclosing a mass $M_r$. 

::: column-margin
[Newton's Shell Theorem](https://en.wikipedia.org/wiki/Shell_theorem) states that the gravitational attraction of a symmetric shell of matter, and therefore by linearity of a ball of matter, can be treated as if the mass were concentrated at a point at the centre. 
:::
The mass of this shell is $M_\text{shell} = \rho A dr$, and from Newton's law of gravitation the magnitude of the gravitational force of the whole shell inwards is 

$$ 
\frac{- G M_r M_\text{shell}}{r^2}
$$

So now we can calculate the net force on this shell (and therefore acceleration $a$), and require the forces to be in balance:

$$
F_\text{net} = M_\text{shell} a = P_\text{below} \cdot A - P_\text{above} \cdot A - \frac{G M_r M_\text{shell}}{r^2}
$$

Letting $P_\text{above} = P_\text{below} + dP$, 

$$
M_\text{shell} a = a \rho A dr = - A dP  - \frac{G M_r M_\text{shell}}{r^2}
$$

and therefore rearranging, in equilibrium ($a = 0$) we have the __equation of hydrostatic equilibrium__:

::: column-margin
*Tattoo this equation on the back of your eyelids.*
:::
$$ 
\frac{dP}{dr} = -\rho \frac{G M_r}{r^2}
$$

<!-- Now we explain in relation to the Earth: 

- pressure under the sea
    - calculate 10m in the (incompressible) water = 1 atmosphere
- atmospheric lapse rate
    - illustrate with figure showing 322.5m Q1 tower, Everest, Kármán line
- plane-parallel solar atmospheric scale height 
-->

This is actually a very familiar equation that we encounter not just in first-year physics, but in everyday life. Nearly all the mass of the Earth is in its body, and only a bit less than a millionth in its atmosphere. So we can consider a situation where 

$$
r = R_{\textcolor{NavyBlue}{\oplus}} + \textcolor{green}{z}
$$

::: column-margin
where $\textcolor{green}{z}$ is the $\textcolor{green}{\text{height}}$ in the atmosphere $\llless R_\oplus$. We often denote astronomical bodies by traditional symbols: $\textcolor{NavyBlue}{\oplus}$ is the astronomical symbol for the $\textcolor{NavyBlue}{\text{Earth}}$, and $\textcolor{yellow}{\odot}$ the $\textcolor{yellow}{\text{Sun}}$. There are many other traditional symbols that are now rarely used.
:::

We can now write this in familiar terms with the acceleration due to gravity as

$$ 
\frac{dP}{dh} = -\rho \cdot \underbrace{\frac{G M_r}{r^2}}_{{\equiv g \text{, constant}}}
$$

<!-- water -->

If we are dealing with an incompressible liquid like water, then $\rho$ is a constant and we simply have 

$$ 
P(z) = P_0 - \rho g z
$$

```{python}
#| echo: false
import numpy as np 
depth = f'{101325/1e3/9.8:.2f}'
```

::: column-margin
We can rearrange this to solve for the depth of water required to reach a gauge pressure $\Delta P \equiv P-P_0$: 
$$
z = - \frac{\Delta P}{\rho g}
$$

For $\rho_\text{water} = 1000 \text{kg\,m}^{-3}$, to get a 1 atmosphere ($=10^6$ Pa) gauge pressure requires `{python} depth` m of water.
:::



Things are different when your density depends on pressure. For an ideal gas, $P = n k_B T$ and $\rho = n \textcolor{OliveGreen}{\langle m \rangle}$ - so we have an *equation of state* that we can use to solve for the vertical structure of an $\textcolor{orange}{\text{isothermal}}$ atmosphere:

::: column-margin
where $\textcolor{OliveGreen}{\langle m \rangle}$ is the $\textcolor{OliveGreen}{\text{mean molecular mass}}$, and $\textcolor{orange}{\text{isothermal}}$ means having the same temperature everywhere, from ἴσος, "same", and θέρμη, "heat".
:::

$$ 
\begin{aligned}
\frac{d}{dz} (n k_B T) &= - \langle m \rangle g n \\
\frac{dn}{dz} &= - \frac{\langle m \rangle g}{k_B T} \cdot N \\ 
n &= n_0 \exp{(- \frac{\langle m \rangle g}{k_B T} z)} \\
n &= n_0 \exp{- z/\textcolor{cyan}{h}}
\end{aligned}
$$ 

and we call 
$\textcolor{cyan}{h}$ the $\textcolor{cyan}{\text{scale height}}$ in the atmosphere. Let's calculate this for some interesting situations!

Let's plug in some numbers for the Sun, using Python:

```{python}
G = 6.6743e-11 # N m2 kg-2; Newton's Constant
k_B = 1.380649e-23 # J/K; Boltzmann's Constant

M_sun = 1.9884e30 # kg
R_sun = 6.957e8 # m
Teff = 5780 # effective temperature, K
m = 0.5 * 1.67262192e-27 # kg
# mean molecular weight for ionized hydrogen = 
# mean of electron & proton = m_p/2

g = G * M_sun / R_sun**2
h = k_B * Teff / m / g
```

```{python}
#| echo: false
g_over_earth = f'{g/9.8:.1f}'
h_fraction = f'{h/R_sun * 1e4:.1f}'
```

giving a gravity $g =$ `{python} g_over_earth` Earth gravities, and a scale height of `{python} h_fraction`$\,\times 10^{-4}\,R_\odot$. So we see that the solar atmosphere has a _tiny_ scale height relative to the overall size of the Sun, and the plane-parallel approximation is probably pretty good!


<!-- Then we explain the idea of scaling relations: how do we estimate the central pressure?

- derive idea that Pc / R = rho GM / R^2 
- estimate central mass of the Sun 
- discuss the general idea of scaling relations in this course: 
    - we are going to find relations for R, L, etc
 -->